{"version":3,"sources":["webpack:///src/page/personal/personal.vue","webpack:///./src/page/personal/personal.vue?3424","webpack:///./src/page/personal/personal.vue"],"names":["personal","data","imageUrl","disabled","btnText","param","userInfo","form","avatar","name","description","_id","mounted","this","getUserInfo","watch","computed","extends_default","Object","vuex_esm","methods","JSON","parse","userinfo","FormData","handleAvatarSuccess","res","file","beforeupload","size","$message","error","windowURL","window","URL","webkitURL","createObjectURL","append","Date","getTime","edit","editSave","_this","indexOf","$store","dispatch","then","code","success","msg","personal_personal","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","action","show-file-list","on-success","before-upload","src","_v","ref","model","label-width","label","$t","clearable","value","callback","$$v","$set","expression","type","rows","placeholder","on","click","_s","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/10.dd2a3dcd2ae6c9d4d7b6.js","sourcesContent":["<template>\n  <div class=\"personal\">\n    <!-- 图片预览编辑 -->\n    <el-upload\n      class=\"avatar-uploader\"\n      action=\"https://jsonplaceholder.typicode.com/posts/\"\n      :show-file-list=\"false\"\n      :on-success=\"handleAvatarSuccess\"\n      :before-upload=\"beforeupload\">\n      <img v-if=\"form.avatar\" :src=\"form.avatar\" class=\"avatar\">\n      <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n    </el-upload>\n\n    <!-- 内容模块 -->\n    <el-form ref=\"form\" class=\"per-form\" :model=\"form\" label-width=\"80px\">\n      <el-form-item :label=\"$t('persinfo.name')\">\n        <el-input v-model=\"form.name\" class=\"input-width\" :disabled=\"disabled\"\n        clearable></el-input>\n      </el-form-item>\n      <el-form-item :label=\"$t('persinfo.description')\">\n        <el-input\n        class=\"input-width\" \n        type=\"textarea\"\n        :rows=\"2\"\n        :disabled=\"disabled\"\n        placeholder=\"请输入内容\"\n        v-model=\"form.description\"\n        clearable>\n        </el-input>\n      </el-form-item>\n      <el-form-item>\n        <el-button @click=\"edit\" ref=\"refBtn\">{{$t('com.edit')}}</el-button>\n        <el-button type=\"primary\" @click=\"editSave\">保存</el-button> \n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport {mapGetters} from 'vuex'\nexport default {\n  data() {\n    return {\n      imageUrl: '',\n      disabled: true,\n      btnText: '',\n      param: null,\n      userInfo: '',\n      form: {\n          avatar: '',\n          name: '',\n          description: '',\n          _id: ''\n      }\n    }\n  },\n  mounted() {\n    this.getUserInfo()\n  },\n  watch: {\n\n  },\n  computed: {\n    ...mapGetters(['userinfo'])\n  },\n  methods: {\n    // 加载用户信息\n    getUserInfo () {\n      this.userInfo = JSON.parse(this.userinfo)\n      this.form = {\n        avatar: this.userInfo.data.avatar || '',\n        name: this.userInfo.data.name,\n        description: this.userInfo.data.description,\n        _id: this.userInfo.data._id\n      }\n      //重新写一个表单上传的方法\n      this.param = new FormData()\n      this.disabled = true\n    },\n    handleAvatarSuccess(res, file) {\n    },\n    beforeupload(file) {\n        const isLt2M = file.size / 1024 / 1024 < 2\n        if (!isLt2M) {\n          this.$message.error('上传头像图片大小不能超过 2MB!')\n          return false\n        }\n        //创建临时的路径来展示图片\n        const windowURL = window.URL || window.webkitURL\n        \n        this.form.avatar=windowURL.createObjectURL(file)\n        this.param.append('avatar', file, new Date().getTime()+'image.png') // 封装到formdata中\n        return false\n    },\n    edit() {\n      this.disabled = !this.disabled\n    },\n    editSave () {\n      // 校验图片链接\n      if (this.form.avatar.indexOf('avatar') > -1 && this.form.avatar){\n         this.param.append('avatar', this.form.avatar)\n      }\n\n      this.param.append('name', this.form.name)\n      this.param.append('description', this.form.description)\n      this.param.append('_id', this.form._id)\n      // if (this.userInfo.data.avatar == this.form.avatar && this.userInfo.data.name == this.form.name && this.userInfo.data.description == this.form.description) {\n      //   this.$message.error('请输入修改信息！')\n      //   return false\n      // }\n\n      this.$store.dispatch('editPersInfo', this.param).then(res=> {\n        if (res.code == 0) {\n          this.$message.success(res.msg)\n          // 重新加载用户信息\n          this.getUserInfo()\n          // 展示刷新整个页面 后面存到vuex 中 更改\n          // window.location.reload()\n        }\n      })\n    }\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n.avatar-uploader .el-upload {\n  border: 1px dashed gray;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #409EFF;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n  border: 1px solid #d9d9d9;\n  border-radius: 50%;\n  margin-top: 10px;\n}\n.avatar {\n  width: 178px;\n  height: 178px;\n  display: block;\n  border-radius: 50%;\n}\n.per-form {\n  .input-width {\n    width: 240px;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/page/personal/personal.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"personal\"},[_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":\"https://jsonplaceholder.typicode.com/posts/\",\"show-file-list\":false,\"on-success\":_vm.handleAvatarSuccess,\"before-upload\":_vm.beforeupload}},[(_vm.form.avatar)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.form.avatar}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})]),_vm._v(\" \"),_c('el-form',{ref:\"form\",staticClass:\"per-form\",attrs:{\"model\":_vm.form,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":_vm.$t('persinfo.name')}},[_c('el-input',{staticClass:\"input-width\",attrs:{\"disabled\":_vm.disabled,\"clearable\":\"\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":_vm.$t('persinfo.description')}},[_c('el-input',{staticClass:\"input-width\",attrs:{\"type\":\"textarea\",\"rows\":2,\"disabled\":_vm.disabled,\"placeholder\":\"请输入内容\",\"clearable\":\"\"},model:{value:(_vm.form.description),callback:function ($$v) {_vm.$set(_vm.form, \"description\", $$v)},expression:\"form.description\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{ref:\"refBtn\",on:{\"click\":_vm.edit}},[_vm._v(_vm._s(_vm.$t('com.edit')))]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.editSave}},[_vm._v(\"保存\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-4508c344\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.2@vue-loader/lib/selector.js?type=template&index=0!./src/page/personal/personal.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4508c344\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=styles&index=0!./personal.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./personal.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./personal.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4508c344\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=template&index=0!./personal.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4508c344\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/page/personal/personal.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}